<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs" lang="cs">
<head>
<title>Method WriteFTPFile of class FTP_SERVICE</title>
<meta content="text/html; charset=windows-1250" http-equiv="Content-Type" />
<meta name="Generator" content="Project Documenting Machine" />
<meta name="Version" content="1.2.3" />
<link rel="stylesheet" href="../../css/foxw.css" type="text/css" />
<link rel="stylesheet" href="../../css/sc.css" type="text/css" />
<link rel="stylesheet" href="../../repository/diamp_pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/pdm_ab_notes.css" type="text/css" />
<link rel="stylesheet" href="../../repository/pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/diaf_pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/diap_pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/diac_pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/ftp.css" type="text/css" />
<script src="../../js/pdm.js" language="JavaScript" type="text/javascript"></script>
<script src="../../repository/pdm_ab.js" language="JavaScript" type="text/javascript"></script>
</head>
<body>
<div class="diaxp_mhead">WriteFTPFile Method</div>
<div class="diaxp_mbody_class">

<table class="clear_table">
 <tbody>
  <tr><td>Class: </td><td><a href="cls.ftp_service.htm" title="Skip to class ftp_service">FTP_SERVICE</a></td></tr>
 </tbody>
</table>
</div>
<div class="diaxp_mbody">
<!-- Created with _diamp_pdm_ab by Agnes Beste    03.09.2007 19:34 -->
 <div class="PDM_AB_Descr"><!-- Descr Begin -->
This method sends a file or string to the FTP server from some local area.
 Depending on how the FTP Server is setup, decides whether or not an existing file is overwritten or if the function fails to send the file.

 </div><!-- Descr End -->

 <div class="DIAMP_PDM_AB_Syntax"><!-- Syntax Begin -->
  <div class="SColor">
   <div class="RetVal"><a href="#_26715XW8E">RetVal</a>&nbsp;</div>   <div class="RetValEq">=</div>   <div class="PEM">
    Object.WriteFTPFile
   </div>
   <div class="Para">
    (<a href="#_26715XW8F">lcRemoteFile</a>
     <wbr />,<a href="#_26715XW8G">lcData</a>
     [<wbr />,<a href="#_26715XW8H">liData</a>
     [<wbr />,<a href="#_26715XW8I">liStart</a>
     [<wbr />,<a href="#_26715XW8J">liFlags</a>
     
     <wbr />,<a href="#_26715XW8K">lnFlag</a>]]])
   </div>
   <div style="clear: both"></div>
  </div><!-- Colour End -->
 </div><!-- Syntax End -->

 <div class="DIAMP_PDM_AB_Params"><!-- Parameters Begin -->
  <span class="PDM_AB_Head">
   Parameter
  </span>
  <dl class="DIAMP_PDM_AB_Params_List">
   <dt class="dt_">
    <a class="DIAMP_PDM_AB_Params_ParaName" id="_26715XW8F" name="_26715XW8F">
     <span class="PDMEXPR PDMNor" ><span class='PDMVar'>lcRemoteFile</span></span>

    </a>
   </dt>
   <dd class="dd_">
    <span class="Params_Short">
     Remote file name
    </span>
    <table class="Params_Info">
     <colgroup>
      <col class="ColumnValue" />
      <col class="ColumnData" />
     </colgroup>
     <tbody>
      <tr>
       <td class="CellValue">Type</td>
       <td class="CellData">Character</td>
      </tr>
      <tr>
       <td class="CellValue">Direction</td>
       <td class="CellData">Input</td>
      </tr>
     </tbody>
    </table>
    <span class="Params_Detail">
Name and Path for the contents of the file to be stored in.
   <!-- Note -->

   <div class="PDM_AB_nExclamation">
    <div class="Block_Picture">
     <img class="NotePicture" title="" src="../../repository/excla.gif">
    </div>
    <div class="Block_Text">
This parameter cannot be empty.
    </div><!-- end of note text -->
    <div style="clear: both"></div>
   </div><!-- end of note -->


    </span>
   </dd>
   <dt class="dt_">
    <a class="DIAMP_PDM_AB_Params_ParaName" id="_26715XW8G" name="_26715XW8G">
     <span class="PDMEXPR PDMNor" ><span class='PDMVar'>lcData</span></span>

    </a>
   </dt>
   <dd class="dd_">
    <span class="Params_Short">
     Data or file name
    </span>
    <table class="Params_Info">
     <colgroup>
      <col class="ColumnValue" />
      <col class="ColumnData" />
     </colgroup>
     <tbody>
      <tr>
       <td class="CellValue">Type</td>
       <td class="CellData">Character</td>
      </tr>
      <tr>
       <td class="CellValue">Direction</td>
       <td class="CellData">Input</td>
      </tr>
     </tbody>
    </table>
    <span class="Params_Detail">
Data or file name which will be send to FTP server.
   <!-- Note -->

   <div class="PDM_AB_nExclamation">
    <div class="Block_Picture">
     <img class="NotePicture" title="" src="../../repository/excla.gif">
    </div>
    <div class="Block_Text">
This parameter cannot be empty.
    </div><!-- end of note text -->
    <div style="clear: both"></div>
   </div><!-- end of note -->


    </span>
   </dd>
   <dt class="dt_">
    <a class="DIAMP_PDM_AB_Params_ParaName" id="_26715XW8H" name="_26715XW8H">
     <span class="PDMEXPR PDMNor" ><span class='PDMVar'>liData</span></span>

    </a>
   </dt>
   <dd class="dd_">
    <span class="Params_Short">
     Buffer size
    </span>
    <table class="Params_Info">
     <colgroup>
      <col class="ColumnValue" />
      <col class="ColumnData" />
     </colgroup>
     <tbody>
      <tr>
       <td class="CellValue">Type</td>
       <td class="CellData">Integer</td>
      </tr>
      <tr>
       <td class="CellValue">Direction</td>
       <td class="CellData">Input</td>
      </tr>
      <tr>
       <td class="CellValue">Optional</td>
      <td class="CellData">&nbsp;</td>
      </tr>
     </tbody>
    </table>
    <span class="Params_Detail">
Buffer size for writing to FTP server.
    </span>
   </dd>
   <dt class="dt_">
    <a class="DIAMP_PDM_AB_Params_ParaName" id="_26715XW8I" name="_26715XW8I">
     <span class="PDMEXPR PDMNor" ><span class='PDMVar'>liStart</span></span>

    </a>
   </dt>
   <dd class="dd_">
    <span class="Params_Short">
     Start position
    </span>
    <table class="Params_Info">
     <colgroup>
      <col class="ColumnValue" />
      <col class="ColumnData" />
     </colgroup>
     <tbody>
      <tr>
       <td class="CellValue">Type</td>
       <td class="CellData">Integer</td>
      </tr>
      <tr>
       <td class="CellValue">Direction</td>
       <td class="CellData">Input</td>
      </tr>
      <tr>
       <td class="CellValue">Optional</td>
      <td class="CellData">&nbsp;</td>
      </tr>
     </tbody>
    </table>
    <span class="Params_Detail">
Start position for resume mode.
    </span>
   </dd>
   <dt class="dt_">
    <a class="DIAMP_PDM_AB_Params_ParaName" id="_26715XW8J" name="_26715XW8J">
     <span class="PDMEXPR PDMNor" ><span class='PDMVar'>liFlags</span></span>

    </a>
   </dt>
   <dd class="dd_">
    <span class="Params_Short">
     Data or file name is source
    </span>
    <table class="Params_Info">
     <colgroup>
      <col class="ColumnValue" />
      <col class="ColumnData" />
     </colgroup>
     <tbody>
      <tr>
       <td class="CellValue">Type</td>
       <td class="CellData">Integer</td>
      </tr>
      <tr>
       <td class="CellValue">Direction</td>
       <td class="CellData">Input</td>
      </tr>
      <tr>
       <td class="CellValue">Optional</td>
      <td class="CellData">&nbsp;</td>
      </tr>
     </tbody>
    </table>
    <span class="Params_Detail">

<table class="listvalues">
 <tr class="Head"><td>Value</td><td>Description</td></tr>
 <tr><td><span class="PDMEXPR PDMNor" ><span class='PDMVar'>_FTPS_RWF_File</span></span>
</td><td><a class="DIAMP_PDM_AB_Para_Link" href="#_26715XW8G">lcData</a> must be file name.</td></tr>
 <tr><td><span class="PDMEXPR PDMNor" ><span class='PDMVar'>_FTPS_RWF_String</span></span>
</td><td><a class="DIAMP_PDM_AB_Para_Link" href="#_26715XW8G">lcData</a> must be string.</td></tr>
 <tr><td><span class="PDMEXPR PDMNor" ><span class='PDMVar'>_FTPS_RWF_Resume</span></span>
</td><td>Resume mode, default.</td></tr>
</table>

    </span>
   </dd>
   <dt class="dt_">
    <a class="DIAMP_PDM_AB_Params_ParaName" id="_26715XW8K" name="_26715XW8K">
     <span class="PDMEXPR PDMNor" ><span class='PDMVar'>lnFlag</span></span>

    </a>
   </dt>
   <dd class="dd_">
    <span class="Params_Short">
     The flags that indicate various options.
    </span>
    <table class="Params_Info">
     <colgroup>
      <col class="ColumnValue" />
      <col class="ColumnData" />
     </colgroup>
     <tbody>
      <tr>
       <td class="CellValue">Type</td>
       <td class="CellData">Numeric</td>
      </tr>
      <tr>
       <td class="CellValue">Direction</td>
       <td class="CellData">Input</td>
      </tr>
     </tbody>
    </table>
    <span class="Params_Detail">
Value is combined with <a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.ncachingtype.htm" title="Skip to property FTP_SERVICE::nCachingType">FTP_SERVICE::nCachingType</a>'s value.
If this parameter ommited, then default value is <span class="PDMEXPR PDMNor" ><span class='PDMVar'>FTP_TRANSFER_TYPE_UNKNOWN</span></span>
.
Can be one of the following:
<table class="listvalues">
 <tr class="Head"><td>Value</td><td>Description</td></tr>
 <tr><td><span class="PDMEXPR PDMNor" ><span class='PDMVar'>FTP_TRANSFER_TYPE_ASCII</span></span>
</td><td>Transfers the file as ASCII.</td></tr>
 <tr><td><span class="PDMEXPR PDMNor" ><span class='PDMVar'>FTP_TRANSFER_TYPE_BINARY</span></span>
</td><td>Transfers the file as binary.</td></tr>
</table>
Assumed from <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wininet/wininet/ftpopenfile.asp">MSDN</a>.
    </span>
   </dd>
  </dl>
 </div><!-- Parameters End -->

 <div class="DIAMP_PDM_AB_RetVal"><!-- Returns Begin -->
  <div>
   <span class="PDM_AB_Head">
    <a id="_26715XW8E" name="_26715XW8E">
     Return value
    </a>
   </span> <span class="RetVal_Ttype">Boolean</span>
  </div>
  <div class="PDM_AB_Body">
The return value is <span class="PDMEXPR PDMNor" ><span class='PDMLit'>.T.</span></span>
 if file is uploaded or <span class="PDMEXPR PDMNor" ><span class='PDMLit'>.F.</span></span>
 is not.
  </div>
 </div><!-- Returns End -->

 <div class="PDM_AB_Example"><!-- Example Begin -->
  <span class="PDM_AB_Head">
   Example
  </span>
  <div class="PDM_AB_Body">

<!-- Code Begin -->
<pre class="PDMCODE PDMNor" >
<span class='PDMResK'>LOCAL</span> <span class='PDMVar'>loFTP</span><span class='PDMOper'>,</span><span class='PDMVar'>lcPom</span>
<span class='PDMOper'>#</span><span class='PDMResK'>INCLUDE</span> <span class='PDMStr'>"ftp.h"</span>
<span class='PDMResK'>SET</span> <span class='PDMResK'>PROCEDURE</span> <span class='PDMResK'>TO</span> <span class='PDMVar'>ftp</span><span class='PDMOper'>.</span><span class='PDMVar'>prg</span> <span class='PDMResK'>ADDITIVE</span> 
<span class='PDMVar'>loFTP</span><span class='PDMOper'>=</span><span class='PDMResF'>CREATEOBJECT</span><span class='PDMOper'>(</span><span class='PDMStr'>'_myftp'</span><span class='PDMOper'>)</span> 

<span class='PDMResK'>IF</span> <span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>OpenInternet</span><span class='PDMOper'>(</span><span class='PDMStr'>"ABONNE"</span><span class='PDMOper'>,</span> <span class='PDMStr'>"PWD"</span><span class='PDMOper'>,</span> <span class='PDMStr'>"10.10.10.10"</span><span class='PDMOper'>,</span> <span class='PDMStr'>"21"</span><span class='PDMOper'>)</span>

<span class='PDMCom'>   * Write remote file into bottom from local file</span>
   <span class='PDMResK'>IF</span> <span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>WriteFtpFile</span><span class='PDMOper'>(</span><span class='PDMStr'>"any.txt"</span><span class='PDMOper'>,</span><span class='PDMStr'>"local.txt"</span><span class='PDMOper'>,</span><span class='PDMLit'>1000</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>STRTRAN</span><span class='PDMOper'>(</span><span class='PDMStr'>"File %File% uploaded"</span><span class='PDMOper'>,</span><span class='PDMStr'>"%File%"</span><span class='PDMOper'>,</span><span class='PDMStr'>"local.txt"</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ELSE</span>
      <span class='PDMOper'>?</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedErrorCode</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedErrorMsg</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ENDIF</span>

<span class='PDMCom'>   * Write remote file into 10. byte (resume mode) from local file</span>
   <span class='PDMResK'>IF</span> <span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>WriteFtpFile</span><span class='PDMOper'>(</span><span class='PDMStr'>"any.txt"</span><span class='PDMOper'>,</span><span class='PDMStr'>"local.txt"</span><span class='PDMOper'>,</span><span class='PDMLit'>1000</span><span class='PDMOper'>,</span><span class='PDMLit'>10</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>STRTRAN</span><span class='PDMOper'>(</span><span class='PDMStr'>"File %File% uploaded"</span><span class='PDMOper'>,</span><span class='PDMStr'>"%File%"</span><span class='PDMOper'>,</span><span class='PDMStr'>"local.txt"</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ELSE</span>
      <span class='PDMOper'>?</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedErrorCode</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedErrorMsg</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ENDIF</span>

<span class='PDMCom'>   * Write remote file into bottom from string</span>
   <span class='PDMVar'>lcPom</span><span class='PDMOper'>=</span><span class='PDMResF'>FILETOSTR</span><span class='PDMOper'>(</span><span class='PDMStr'>"local.txt"</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>IF</span> <span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>WriteFtpFile</span><span class='PDMOper'>(</span><span class='PDMStr'>"any.txt"</span><span class='PDMOper'>,</span><span class='PDMOper'>@</span><span class='PDMVar'>lcPom</span><span class='PDMOper'>,</span><span class='PDMLit'>1000</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>,</span><span class='PDMVar'>_FTPS_RWF_String</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>STRTRAN</span><span class='PDMOper'>(</span><span class='PDMStr'>"File %File% uploaded"</span><span class='PDMOper'>,</span><span class='PDMStr'>"%File%"</span><span class='PDMOper'>,</span><span class='PDMStr'>"local.txt"</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ELSE</span>
      <span class='PDMOper'>?</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedErrorCode</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedErrorMsg</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ENDIF</span>

<span class='PDMCom'>   * Write remote file into 10. byte from string</span>
   <span class='PDMVar'>lcPom</span><span class='PDMOper'>=</span><span class='PDMResF'>FILETOSTR</span><span class='PDMOper'>(</span><span class='PDMStr'>"local.txt"</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>IF</span> <span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>WriteFtpFile</span><span class='PDMOper'>(</span><span class='PDMStr'>"any.txt"</span><span class='PDMOper'>,</span><span class='PDMOper'>@</span><span class='PDMVar'>lcPom</span><span class='PDMOper'>,</span><span class='PDMLit'>1000</span><span class='PDMOper'>,</span><span class='PDMLit'>10</span><span class='PDMOper'>,</span><span class='PDMVar'>_FTPS_RWF_String</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>STRTRAN</span><span class='PDMOper'>(</span><span class='PDMStr'>"File %File% uploaded"</span><span class='PDMOper'>,</span><span class='PDMStr'>"%File%"</span><span class='PDMOper'>,</span><span class='PDMStr'>"local.txt"</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ELSE</span>
      <span class='PDMOper'>?</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedErrorCode</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedErrorMsg</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ENDIF</span>

   <span class='PDMOper'>=</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>CloseInternet</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span> 
<span class='PDMResK'>ENDIF</span>
<span class='PDMResK'>RELEASE</span> <span class='PDMResK'>PROCEDURE</span> <span class='PDMVar'>ftp</span><span class='PDMOper'>.</span><span class='PDMVar'>prg</span>

<span class='PDMResK'>DEFINE</span> <span class='PDMResK'>CLASS</span> <span class='PDMVar'>_myFTP</span> <span class='PDMResK'>AS</span> <span class='PDMVar'>FTP_SERVICE</span>
   <span class='PDMResK'>PROCEDURE</span> <span class='PDMVar'>BeforeWriteFTPFile</span><span class='PDMOper'>(</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>PROGRAM</span><span class='PDMOper'>(</span><span class='PDMLit'>16</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>CHR</span><span class='PDMOper'>(</span><span class='PDMLit'>9</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span>
   <span class='PDMResK'>ENDPROC</span>

   <span class='PDMResK'>PROCEDURE</span> <span class='PDMVar'>AfterWriteFTPFile</span><span class='PDMOper'>(</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>,</span><span class='PDMVar'>fResult</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>PROGRAM</span><span class='PDMOper'>(</span><span class='PDMLit'>16</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>CHR</span><span class='PDMOper'>(</span><span class='PDMLit'>9</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>fResult</span>
   <span class='PDMResK'>ENDPROC</span>

   <span class='PDMResK'>PROCEDURE</span> <span class='PDMVar'>AtWriteFTPFile</span><span class='PDMOper'>(</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>,</span><span class='PDMVar'>lii</span><span class='PDMOper'>,</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>,</span><span class='PDMVar'>fResult</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>PROGRAM</span><span class='PDMOper'>(</span><span class='PDMLit'>16</span><span class='PDMOper'>)</span>
      <span class='PDMOper'>?</span><span class='PDMResF'>CHR</span><span class='PDMOper'>(</span><span class='PDMLit'>9</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lii</span><span class='PDMOper'>,</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>,</span><span class='PDMVar'>fResult</span>
   <span class='PDMResK'>ENDPROC</span>
<span class='PDMResK'>ENDDEFINE</span> </pre>
 <!-- Code End -->


  </div>
 </div><!-- Example End -->

 <div class="PDM_AB_SeeAlso"><!-- SeeAlso Begin -->
  <span class="PDM_AB_Head">
   See also
  </span>
  <div class="PDM_AB_Body">
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.beforewriteftpfile.htm" title="Skip to method FTP_SERVICE::BeforeWriteFTPFile()">FTP_SERVICE::BeforeWriteFTPFile()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.afterwriteftpfile.htm" title="Skip to method FTP_SERVICE::AfterWriteFTPFile()">FTP_SERVICE::AfterWriteFTPFile()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.atwriteftpfile.htm" title="Skip to method FTP_SERVICE::AtWriteFTPFile()">FTP_SERVICE::AtWriteFTPFile()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.getftpfile.htm" title="Skip to method FTP_SERVICE::GetFTPFile()">FTP_SERVICE::GetFTPFile()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.readftpfile.htm" title="Skip to method FTP_SERVICE::ReadFTPFile()">FTP_SERVICE::ReadFTPFile()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.putftpfile.htm" title="Skip to method FTP_SERVICE::PutFTPFile()">FTP_SERVICE::PutFTPFile()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.ftpcommand.htm" title="Skip to method FTP_SERVICE::FTPCommand()">FTP_SERVICE::FTPCommand()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.deleteftpfile.htm" title="Skip to method FTP_SERVICE::DeleteFTPFile()">FTP_SERVICE::DeleteFTPFile()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.renameftpfile.htm" title="Skip to method FTP_SERVICE::RenameFTPFile()">FTP_SERVICE::RenameFTPFile()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.createftpdirectory.htm" title="Skip to method FTP_SERVICE::CreateFTPDirectory()">FTP_SERVICE::CreateFTPDirectory()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.removeftpdirectory.htm" title="Skip to method FTP_SERVICE::RemoveFTPDirectory()">FTP_SERVICE::RemoveFTPDirectory()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.changeftpdirectory.htm" title="Skip to method FTP_SERVICE::ChangeFTPDirectory()">FTP_SERVICE::ChangeFTPDirectory()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.getftpdirectory.htm" title="Skip to method FTP_SERVICE::GetFTPDirectory()">FTP_SERVICE::GetFTPDirectory()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.getftpdirectoryarray.htm" title="Skip to method FTP_SERVICE::GetFTPDirectoryArray()">FTP_SERVICE::GetFTPDirectoryArray()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.ncachingtype.htm" title="Skip to property FTP_SERVICE::nCachingType">FTP_SERVICE::nCachingType</a>
  </div><!-- Body End -->
  <!--- "Applies to" need to be inserted here---->
  <PlaceAppliesTo_Here />
  <!--- /"Applies to" need to be inserted here---->
 </div><!-- SeeAlso End -->


<!-- /Created with _diamp_pdm_ab by Agnes Beste    03.09.2007 19:34 -->

 <div class="SC">
  <img onclick="ExpandSC('SP_1',-1);"class="imgEC" src="../../imgs/uptab.gif" alt="Expand/Collapse source code of procedure WriteFTPFile" id="IMG_SP_1" />
  <span ondblclick="ExpandSC('SP_1',-1);" class="SCCaption"><a name="FTP_SERVICE">Source Code</a></span>
  <div ondblclick="ExpandSC('SP_1',-1);" class="SCE" id="TX_SP_1">
<!-- Code Begin -->
<pre class="PDMCODE PDMNor" >      <span class='PDMResK'>LPARAMETERS</span> <span class='PDMVar'>INP</span> <span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>INP</span> <span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>OPT_INP</span> <span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>OPT_INP</span> <span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>OPT_INP</span> <span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>OPT_INP</span> <span class='PDMVar'>lnFlag</span>
      <span class='PDMResK'>LOCAL</span> <span class='PDMVar'>fResult</span><span class='PDMOper'>,</span><span class='PDMVar'>lihFTP</span><span class='PDMOper'>,</span><span class='PDMVar'>lcBuffer</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>,</span><span class='PDMVar'>lihFile</span><span class='PDMOper'>,</span><span class='PDMVar'>lcAll</span><span class='PDMOper'>,</span><span class='PDMVar'>lcAlias</span><span class='PDMOper'>,</span><span class='PDMVar'>liSele</span><span class='PDMOper'>,</span><span class='PDMVar'>llErr</span><span class='PDMOper'>,</span><span class='PDMVar'>lcError</span>
      <span class='PDMResK'>LOCAL</span> <span class='PDMResK'>ARRAY</span> <span class='PDMVar'>laFile</span><span class='PDMOper'>(</span><span class='PDMLit'>1</span><span class='PDMOper'>)</span>
      <span class='PDMVar'>lihFile</span><span class='PDMOper'>=</span><span class='PDMLit'>0</span>

      <span class='PDMVar'>liData</span><span class='PDMOper'>=</span><span class='PDMResF'>IIF</span><span class='PDMOper'>(</span><span class='PDMResF'>PCOUNT</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>&lt;</span><span class='PDMLit'>3</span><span class='PDMOper'>,</span><span class='PDMLit'>512</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>)</span>
      <span class='PDMVar'>liData</span><span class='PDMOper'>=</span><span class='PDMResF'>IIF</span><span class='PDMOper'>(</span><span class='PDMVar'>liData</span><span class='PDMOper'>&lt;=</span><span class='PDMLit'>0</span><span class='PDMOper'>,</span><span class='PDMLit'>512</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>)</span>

      <span class='PDMVar'>liStart</span><span class='PDMOper'>=</span><span class='PDMResF'>IIF</span><span class='PDMOper'>(</span><span class='PDMResF'>PCOUNT</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>&lt;</span><span class='PDMLit'>4</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>)</span>
      <span class='PDMVar'>liFlags</span><span class='PDMOper'>=</span><span class='PDMResF'>IIF</span><span class='PDMOper'>(</span><span class='PDMResF'>PCOUNT</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>&lt;</span><span class='PDMLit'>5</span><span class='PDMOper'>,</span><span class='PDMVar'>_FTPS_RWF_File</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>)</span>
      <span class='PDMVar'>lnFlag</span><span class='PDMOper'>=</span><span class='PDMResF'>IIF</span><span class='PDMOper'>(</span><span class='PDMResF'>PCOUNT</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>&lt;</span><span class='PDMLit'>6</span><span class='PDMOper'>,</span><span class='PDMVar'>FTP_TRANSFER_TYPE_UNKNOWN</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>)</span>
      <span class='PDMVar'>liSele</span><span class='PDMOper'>=</span><span class='PDMResF'>SELECT</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>
      <span class='PDMVar'>lcAlias</span><span class='PDMOper'>=</span><span class='PDMResF'>SYS</span><span class='PDMOper'>(</span><span class='PDMLit'>2015</span><span class='PDMOper'>)</span>

      <span class='PDMResK'>IF</span> <span class='PDMOper'>!</span><span class='PDMResF'>BITTEST</span><span class='PDMOper'>(</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>)</span> <span class='PDMCom'>&amp;&amp; File?</span>
         <span class='PDMResK'>IF</span> <span class='PDMResF'>ADIR</span><span class='PDMOper'>(</span><span class='PDMVar'>laFile</span><span class='PDMOper'>,</span><span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMStr'>"RSHA"</span><span class='PDMOper'>)</span><span class='PDMOper'>=</span><span class='PDMLit'>0</span> <span class='PDMCom'>&amp;&amp; safety than FILE()</span>
            <span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>SetExtendedError</span><span class='PDMOper'>(</span><span class='PDMVar'>_FTPS_UE_FNEXISTS</span><span class='PDMOper'>,</span><span class='PDMVar'>lcData</span><span class='PDMOper'>)</span>
            <span class='PDMResK'>RETURN</span> <span class='PDMLit'>.F.</span>
         <span class='PDMResK'>ENDIF</span>

         <span class='PDMResK'>CREATE</span> <span class='PDMResK'>CURSOR</span> <span class='PDMOper'>(</span><span class='PDMVar'>lcAlias</span><span class='PDMOper'>)</span> <span class='PDMOper'>(</span><span class='PDMVar'>XX000</span> <span class='PDMVar'>M</span> <span class='PDMResK'>NOCPTRANS</span><span class='PDMOper'>)</span>
         <span class='PDMResK'>APPEND</span> <span class='PDMResK'>BLANK</span>
         <span class='PDMOper'>#</span><span class='PDMResK'>IF</span> <span class='PDMResF'>VAL</span><span class='PDMOper'>(</span><span class='PDMResF'>STRTRAN</span><span class='PDMOper'>(</span><span class='PDMResF'>SUBS</span><span class='PDMOper'>(</span><span class='PDMResF'>VERSION</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMResF'>LEN</span><span class='PDMOper'>(</span><span class='PDMStr'>"Visual FoxPro "</span><span class='PDMOper'>)</span><span class='PDMOper'>+</span><span class='PDMLit'>1</span><span class='PDMOper'>,</span><span class='PDMLit'>2</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMStr'>"0"</span><span class='PDMOper'>,</span><span class='PDMStr'>""</span><span class='PDMOper'>)</span><span class='PDMOper'>)</span><span class='PDMOper'>&gt;=</span><span class='PDMLit'>8</span>
          <span class='PDMResK'>TRY</span>
           <span class='PDMResK'>APPEND</span> <span class='PDMResK'>MEMO</span> <span class='PDMVar'>XX000</span> <span class='PDMResK'>FROM</span> <span class='PDMOper'>(</span><span class='PDMVar'>lcData</span><span class='PDMOper'>)</span>
          <span class='PDMResK'>CATCH</span>
           <span class='PDMVar'>llErr</span><span class='PDMOper'>=</span><span class='PDMLit'>.T.</span>
          <span class='PDMResK'>FINALLY</span>
          <span class='PDMResK'>ENDTRY</span>
         <span class='PDMOper'>#</span><span class='PDMResK'>ELSE</span>
           <span class='PDMVar'>lcError</span><span class='PDMOper'>=</span><span class='PDMResK'>ON</span><span class='PDMOper'>(</span><span class='PDMStr'>"ERROR"</span><span class='PDMOper'>)</span> 
           <span class='PDMResK'>ON</span> <span class='PDMResK'>ERROR</span> <span class='PDMVar'>llErr</span><span class='PDMOper'>=</span><span class='PDMLit'>.T.</span>
           <span class='PDMResK'>APPEND</span> <span class='PDMResK'>MEMO</span> <span class='PDMVar'>XX000</span> <span class='PDMResK'>FROM</span> <span class='PDMOper'>(</span><span class='PDMVar'>lcData</span><span class='PDMOper'>)</span>
         <span class='PDMOper'>#</span><span class='PDMResK'>ENDIF</span>
         <span class='PDMResK'>IF</span> <span class='PDMVar'>llErr</span> <span class='PDMCom'>&amp;&amp; bug at reading file from disk</span>
            <span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>SetExtendedError</span><span class='PDMOper'>(</span><span class='PDMVar'>_FTPS_UE_CNF</span><span class='PDMOper'>,</span><span class='PDMVar'>lcData</span><span class='PDMOper'>)</span>
            <span class='PDMResK'>RETURN</span> <span class='PDMLit'>.F.</span>
         <span class='PDMResK'>ENDIF</span>
      <span class='PDMResK'>ELSE</span>
         <span class='PDMResK'>IF</span> <span class='PDMResF'>TYPE</span><span class='PDMOper'>(</span><span class='PDMStr'>"lcData"</span><span class='PDMOper'>)</span><span class='PDMOper'>#</span><span class='PDMStr'>"C"</span>
            <span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>SetExtendedError</span><span class='PDMOper'>(</span><span class='PDMLit'>11</span><span class='PDMOper'>,</span><span class='PDMStr'>"Function argument value, type, or count is invalid."</span><span class='PDMOper'>)</span>
            <span class='PDMResK'>RETURN</span> <span class='PDMLit'>.F.</span>
         <span class='PDMResK'>ENDIF</span>
<span class='PDMCom'>*         lcData=SUBST(lcData,liStart+1)</span>
      <span class='PDMResK'>ENDIF</span>

      <span class='PDMResK'>IF</span> <span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>OpenFTPConnection</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>cCurrentDir</span><span class='PDMOper'>)</span>    <span class='PDMCom'>&amp;&amp; Open an FTP Handle</span>
         <span class='PDMVar'>lcRemoteFile</span> <span class='PDMOper'>=</span> <span class='PDMVar'>lcRemoteFile</span> <span class='PDMOper'>+</span> <span class='PDMVar'>cNULL</span>

         <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>BeforeWriteFTPFile</span><span class='PDMOper'>(</span><span class='PDMOper'>@</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>)</span>

         <span class='PDMResK'>IF</span> <span class='PDMVar'>liStart</span><span class='PDMOper'>&gt;</span><span class='PDMLit'>0</span> <span class='PDMCom'>&amp;&amp; Part data</span>
<span class='PDMCom'>            * Append file</span>
            <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>FTPCommand</span><span class='PDMOper'>(</span><span class='PDMStr'>"REST "</span><span class='PDMOper'>+</span><span class='PDMResF'>LTRIM</span><span class='PDMOper'>(</span><span class='PDMResF'>STR</span><span class='PDMOper'>(</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMLit'>11</span><span class='PDMOper'>)</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span> <span class='PDMVar'>lnFlag</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>,</span><span class='PDMOper'>.</span><span class='PDMResK'>NULL</span><span class='PDMOper'>.</span><span class='PDMOper'>)</span>
            <span class='PDMVar'>fResult</span><span class='PDMOper'>=</span><span class='PDMResF'>IIF</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>FTPCommand</span><span class='PDMOper'>(</span><span class='PDMStr'>"APPE "</span><span class='PDMOper'>+</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>lnFlag</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>,</span><span class='PDMOper'>@</span><span class='PDMVar'>lihFTP</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMLit'>1</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>)</span>
         <span class='PDMResK'>ENDIF</span>

         <span class='PDMResK'>STORE</span> <span class='PDMVar'>FtpOpenFile</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>nConnect_Handle</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMVar'>GENERIC_WRITE</span><span class='PDMOper'>,</span> <span class='PDMOper'>;</span>
                           <span class='PDMResF'>BITOR</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>nCachingType</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span> <span class='PDMLit'>0</span><span class='PDMOper'>)</span> <span class='PDMResK'>TO</span> <span class='PDMVar'>fResult</span><span class='PDMOper'>,</span><span class='PDMVar'>lihFTP</span>
         <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedError</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>

         <span class='PDMResK'>IF</span> <span class='PDMVar'>fResult</span> <span class='PDMOper'>#</span><span class='PDMLit'>0</span> <span class='PDMCom'>&amp;&amp; OK, FTP file is openned</span>
            <span class='PDMResK'>DO</span> <span class='PDMResK'>CASE</span>
               <span class='PDMResK'>CASE</span> <span class='PDMOper'>!</span><span class='PDMResF'>BITTEST</span><span class='PDMOper'>(</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>)</span> <span class='PDMOper'>AND</span> <span class='PDMVar'>liStart</span><span class='PDMOper'>&gt;=</span><span class='PDMResF'>LEN</span><span class='PDMOper'>(</span><span class='PDMVar'>XX000</span><span class='PDMOper'>)</span> <span class='PDMOper'>OR</span><span class='PDMOper'>;</span>
                     <span class='PDMResF'>BITTEST</span><span class='PDMOper'>(</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>)</span> <span class='PDMOper'>AND</span> <span class='PDMResF'>LEN</span><span class='PDMOper'>(</span><span class='PDMVar'>lcData</span><span class='PDMOper'>)</span><span class='PDMOper'>=</span><span class='PDMLit'>0</span> <span class='PDMCom'>&amp;&amp; prázdný soubor nebo prázdná data</span>
                    <span class='PDMVar'>lcBuffer</span><span class='PDMOper'>=</span><span class='PDMStr'>""</span>
                    <span class='PDMVar'>liData</span><span class='PDMOper'>=</span><span class='PDMResF'>LEN</span><span class='PDMOper'>(</span><span class='PDMVar'>lcBuffer</span><span class='PDMOper'>)</span>

                    <span class='PDMVar'>liWrite</span><span class='PDMOper'>=</span><span class='PDMLit'>0</span>
                    <span class='PDMVar'>fResult</span> <span class='PDMOper'>=</span> <span class='PDMVar'>InternetWriteFile</span><span class='PDMOper'>(</span><span class='PDMVar'>lihFTP</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcBuffer</span><span class='PDMOper'>,</span> <span class='PDMVar'>liData</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>)</span>
                    <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedError</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>
                    <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>AtWriteFTPFile</span><span class='PDMOper'>(</span><span class='PDMOper'>@</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>,</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>,</span><span class='PDMVar'>fResult</span><span class='PDMOper'>)</span>

               <span class='PDMResK'>CASE</span> <span class='PDMOper'>!</span><span class='PDMResF'>BITTEST</span><span class='PDMOper'>(</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>)</span> <span class='PDMCom'>&amp;&amp; File from string</span>
                    <span class='PDMVar'>lii</span><span class='PDMOper'>=</span><span class='PDMVar'>liStart</span><span class='PDMOper'>+</span><span class='PDMLit'>1</span>

                    <span class='PDMResK'>DO</span> <span class='PDMResK'>WHILE</span> <span class='PDMVar'>lii</span><span class='PDMOper'>&lt;</span><span class='PDMResF'>LEN</span><span class='PDMOper'>(</span><span class='PDMVar'>XX000</span><span class='PDMOper'>)</span>
                       <span class='PDMVar'>lcBuffer</span><span class='PDMOper'>=</span><span class='PDMResF'>SUBST</span><span class='PDMOper'>(</span><span class='PDMVar'>XX000</span><span class='PDMOper'>,</span><span class='PDMVar'>lii</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>)</span>
                       <span class='PDMVar'>liData</span><span class='PDMOper'>=</span><span class='PDMResF'>LEN</span><span class='PDMOper'>(</span><span class='PDMVar'>lcBuffer</span><span class='PDMOper'>)</span>

                       <span class='PDMVar'>liWrite</span><span class='PDMOper'>=</span><span class='PDMLit'>0</span>
                       <span class='PDMVar'>fResult</span> <span class='PDMOper'>=</span> <span class='PDMVar'>InternetWriteFile</span><span class='PDMOper'>(</span><span class='PDMVar'>lihFTP</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcBuffer</span><span class='PDMOper'>,</span> <span class='PDMVar'>liData</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>)</span>
                       <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedError</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>
                       <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>AtWriteFTPFile</span><span class='PDMOper'>(</span><span class='PDMOper'>@</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>,</span><span class='PDMVar'>lii</span><span class='PDMOper'>,</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>,</span><span class='PDMVar'>fResult</span><span class='PDMOper'>)</span>
                       <span class='PDMResK'>IF</span> <span class='PDMVar'>fResult</span><span class='PDMOper'>#</span><span class='PDMLit'>1</span>
                          <span class='PDMResK'>EXIT</span>
                       <span class='PDMResK'>ENDIF</span>
                       <span class='PDMVar'>lii</span><span class='PDMOper'>=</span><span class='PDMVar'>lii</span><span class='PDMOper'>+</span><span class='PDMVar'>liData</span>
                    <span class='PDMResK'>ENDDO</span>

               <span class='PDMResK'>CASE</span> <span class='PDMResF'>BITTEST</span><span class='PDMOper'>(</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>)</span> <span class='PDMCom'>&amp;&amp; String data</span>
                    <span class='PDMVar'>lii</span><span class='PDMOper'>=</span><span class='PDMVar'>liStart</span><span class='PDMOper'>+</span><span class='PDMLit'>1</span>

                    <span class='PDMResK'>DO</span> <span class='PDMResK'>WHILE</span> <span class='PDMVar'>lii</span><span class='PDMOper'>&lt;</span><span class='PDMResF'>LEN</span><span class='PDMOper'>(</span><span class='PDMVar'>lcData</span><span class='PDMOper'>)</span>
                       <span class='PDMVar'>lcBuffer</span><span class='PDMOper'>=</span><span class='PDMResF'>SUBST</span><span class='PDMOper'>(</span><span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>lii</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>)</span>
                       <span class='PDMVar'>liData</span><span class='PDMOper'>=</span><span class='PDMResF'>LEN</span><span class='PDMOper'>(</span><span class='PDMVar'>lcBuffer</span><span class='PDMOper'>)</span>

                       <span class='PDMVar'>liWrite</span><span class='PDMOper'>=</span><span class='PDMLit'>0</span>
                       <span class='PDMVar'>fResult</span> <span class='PDMOper'>=</span> <span class='PDMVar'>InternetWriteFile</span><span class='PDMOper'>(</span><span class='PDMVar'>lihFTP</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcBuffer</span><span class='PDMOper'>,</span> <span class='PDMVar'>liData</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>)</span>
                       <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>GetExtendedError</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span>
                       <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>AtWriteFTPFile</span><span class='PDMOper'>(</span><span class='PDMOper'>@</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>,</span><span class='PDMVar'>lii</span><span class='PDMOper'>,</span><span class='PDMVar'>liWrite</span><span class='PDMOper'>,</span><span class='PDMVar'>fResult</span><span class='PDMOper'>)</span>
                       <span class='PDMResK'>IF</span> <span class='PDMVar'>fResult</span><span class='PDMOper'>#</span><span class='PDMLit'>1</span>
                          <span class='PDMResK'>EXIT</span>
                       <span class='PDMResK'>ENDIF</span>
                       <span class='PDMVar'>lii</span><span class='PDMOper'>=</span><span class='PDMVar'>lii</span><span class='PDMOper'>+</span><span class='PDMVar'>liData</span>
                    <span class='PDMResK'>ENDDO</span>

            <span class='PDMResK'>ENDCASE</span>

            <span class='PDMOper'>=</span><span class='PDMResF'>IIF</span><span class='PDMOper'>(</span><span class='PDMVar'>liStart</span><span class='PDMOper'>&gt;</span><span class='PDMLit'>0</span><span class='PDMOper'>,</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>_FTPCommand</span><span class='PDMOper'>(</span><span class='PDMStr'>"NOOP"</span><span class='PDMOper'>,</span> <span class='PDMVar'>FTP_TRANSFER_TYPE_BINARY</span><span class='PDMOper'>,</span><span class='PDMLit'>0</span><span class='PDMOper'>,</span><span class='PDMOper'>.</span><span class='PDMResK'>NULL</span><span class='PDMOper'>.</span><span class='PDMOper'>)</span><span class='PDMOper'>,</span><span class='PDMLit'>.T.</span><span class='PDMOper'>)</span>
            <span class='PDMOper'>=</span><span class='PDMVar'>InternetCloseHandle</span><span class='PDMOper'>(</span><span class='PDMVar'>lihFTP</span><span class='PDMOper'>)</span>
         <span class='PDMResK'>ENDIF</span>
         <span class='PDMResK'>IF</span> <span class='PDMResF'>USED</span><span class='PDMOper'>(</span><span class='PDMVar'>lcAlias</span><span class='PDMOper'>)</span>
            <span class='PDMResK'>USE</span> <span class='PDMResK'>IN</span> <span class='PDMOper'>(</span><span class='PDMVar'>lcAlias</span><span class='PDMOper'>)</span>
         <span class='PDMResK'>ENDIF</span>
         <span class='PDMResK'>SELECT</span> <span class='PDMOper'>(</span><span class='PDMVar'>liSele</span><span class='PDMOper'>)</span>

         <span class='PDMOper'>=</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>AfterWriteFTPFile</span><span class='PDMOper'>(</span><span class='PDMOper'>@</span><span class='PDMVar'>lcRemoteFile</span><span class='PDMOper'>,</span> <span class='PDMOper'>@</span><span class='PDMVar'>lcData</span><span class='PDMOper'>,</span><span class='PDMVar'>liData</span><span class='PDMOper'>,</span><span class='PDMVar'>liStart</span><span class='PDMOper'>,</span><span class='PDMVar'>liFlags</span><span class='PDMOper'>,</span><span class='PDMVar'>lnFlag</span><span class='PDMOper'>,</span><span class='PDMVar'>fResult</span><span class='PDMOper'>)</span>
         <span class='PDMOper'>=</span><span class='PDMResF'>IIF</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>lMultiOperations</span><span class='PDMOper'>,</span><span class='PDMLit'>.T.</span><span class='PDMOper'>,</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>CloseFTPConnection</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span><span class='PDMOper'>)</span>   <span class='PDMCom'>&amp;&amp; Close FTP Handle</span>

         <span class='PDMResK'>RETURN</span> <span class='PDMVar'>fResult</span> <span class='PDMOper'>=</span> <span class='PDMLit'>1</span>
      <span class='PDMResK'>ENDIF</span>
      <span class='PDMResK'>RETURN</span> <span class='PDMLit'>.F.</span></pre>
 <!-- Code End -->
  </div>
 </div>
</div>
<div class="diaxp_mfoot"> <div class="PDM_AB_CopyRight"><!-- Footer Begin -->
  <hr />
  <div class="PDM_AB_Body">
&copy; 24.11.2005 Martina Jindr&uacute;
  </div><!-- Body End -->
 </div><!-- Footer End -->
</div>
<script language="JavaScript" type="text/javascript">
lo=document.getElementById("TX_SP_1");
lo.XType="SourceCode";
lo.Dir="../../imgs/";


</script>
</body>
</html>
