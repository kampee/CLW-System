<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs" lang="cs">
<head>
<title>Method GetErrorCode of class FTP_SERVICE</title>
<meta content="text/html; charset=windows-1250" http-equiv="Content-Type" />
<meta name="Generator" content="Project Documenting Machine" />
<meta name="Version" content="1.2.3" />
<link rel="stylesheet" href="../../css/foxw.css" type="text/css" />
<link rel="stylesheet" href="../../css/sc.css" type="text/css" />
<link rel="stylesheet" href="../../repository/diamp_pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/pdm_ab_notes.css" type="text/css" />
<link rel="stylesheet" href="../../repository/pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/diaf_pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/diap_pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/diac_pdm_ab.css" type="text/css" />
<link rel="stylesheet" href="../../repository/ftp.css" type="text/css" />
<script src="../../js/pdm.js" language="JavaScript" type="text/javascript"></script>
<script src="../../repository/pdm_ab.js" language="JavaScript" type="text/javascript"></script>
</head>
<body>
<div class="diaxp_mhead">GetErrorCode Method</div>
<div class="diaxp_mbody_class">

<table class="clear_table">
 <tbody>
  <tr><td>Class: </td><td><a href="cls.ftp_service.htm" title="Skip to class ftp_service">FTP_SERVICE</a></td></tr>
 </tbody>
</table>
</div>
<div class="diaxp_mbody">
<!-- Created with _diamp_pdm_ab by Agnes Beste    03.09.2007 19:34 -->
 <div class="PDM_AB_Descr"><!-- Descr Begin -->
This method is the watch dog of this FTP Service.
 After every FTP function is performed, return codes, error codes and messages are stored internally.
 This method retrieves the last error code generated by a FTP function call.
<p />
 Extended error codes and messages are generated during each API call. 
 This extended information is also stored after each function call.
<p />
If <a class="DIAMP_PDM_AB_Para_Link" href="#_26715Y8IN">llShowMessage</a> is set to <span class="PDMEXPR PDMNor" ><span class='PDMLit'>.T.</span></span>
, a message box will be displayed showing the last error code with the text relating to that error code.
 Also the extended error code and message is displayed.
<p />
Most of the time, the <a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.nresult_code.htm" title="Skip to property FTP_SERVICE::nResult_Code">FTP_SERVICE::nResult_Code</a> will be <span class="PDMEXPR PDMNor" ><span class='PDMLit'>0</span></span>
 if the function succeded. 
<p />
In some cases, the <a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.nresult_code.htm" title="Skip to property FTP_SERVICE::nResult_Code">FTP_SERVICE::nResult_Code</a>
 will be different than <span class="PDMEXPR PDMNor" ><span class='PDMLit'>0</span></span>
 if the function succeded.
 For example, this method returns <span class="PDMEXPR PDMNor" ><span class='PDMVar'>ERROR_NO_MORE_FILES</span></span>
 after the function <a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.getftpdirectoryarray.htm" title="Skip to method FTP_SERVICE::GetFTPDirectoryArray()">FTP_SERVICE::GetFTPDirectoryArray()</a>
 succeds.
 So it is important to check to see if the function succeded and then check the error codes.

 </div><!-- Descr End -->

 <div class="DIAMP_PDM_AB_Syntax"><!-- Syntax Begin -->
  <div class="SColor">
   <div class="RetVal"><a href="#_26715Y8IM">RetVal</a>&nbsp;</div>   <div class="RetValEq">=</div>   <div class="PEM">
    Object.GetErrorCode
   </div>
   <div class="Para">
    (<a href="#_26715Y8IN">llShowMessage</a>)
   </div>
   <div style="clear: both"></div>
  </div><!-- Colour End -->
 </div><!-- Syntax End -->

 <div class="DIAMP_PDM_AB_Params"><!-- Parameters Begin -->
  <span class="PDM_AB_Head">
   Parameter
  </span>
  <dl class="DIAMP_PDM_AB_Params_List">
   <dt class="dt_">
    <a class="DIAMP_PDM_AB_Params_ParaName" id="_26715Y8IN" name="_26715Y8IN">
     <span class="PDMEXPR PDMNor" ><span class='PDMVar'>llShowMessage</span></span>

    </a>
   </dt>
   <dd class="dd_">
    <span class="Params_Short">
     Show message?
    </span>
    <table class="Params_Info">
     <colgroup>
      <col class="ColumnValue" />
      <col class="ColumnData" />
     </colgroup>
     <tbody>
      <tr>
       <td class="CellValue">Type</td>
       <td class="CellData">Boolean</td>
      </tr>
      <tr>
       <td class="CellValue">Direction</td>
       <td class="CellData">Input</td>
      </tr>
     </tbody>
    </table>
    <span class="Params_Detail">
Set to <span class="PDMEXPR PDMNor" ><span class='PDMLit'>.T.</span></span>
 to display a MessageBox on the screen.
    </span>
   </dd>
  </dl>
 </div><!-- Parameters End -->

 <div class="DIAMP_PDM_AB_RetVal"><!-- Returns Begin -->
  <div>
   <span class="PDM_AB_Head">
    <a id="_26715Y8IM" name="_26715Y8IM">
     Return value
    </a>
   </span> <span class="RetVal_Ttype">Numeric</span>
  </div>
  <div class="PDM_AB_Body">
Returns the error code from the last FTP function as a numeric value.

  </div>
 </div><!-- Returns End -->

 <div class="PDM_AB_Example"><!-- Example Begin -->
  <span class="PDM_AB_Head">
   Example
  </span>
  <div class="PDM_AB_Body">

<!-- Code Begin -->
<pre class="PDMCODE PDMNor" >
<span class='PDMResK'>LOCAL</span> <span class='PDMVar'>loFTP</span><span class='PDMOper'>,</span><span class='PDMVar'>lcPom</span>
<span class='PDMOper'>#</span><span class='PDMResK'>INCLUDE</span> <span class='PDMStr'>"ftp.h"</span>
<span class='PDMResK'>SET</span> <span class='PDMResK'>PROCEDURE</span> <span class='PDMResK'>TO</span> <span class='PDMVar'>ftp</span><span class='PDMOper'>.</span><span class='PDMVar'>prg</span> <span class='PDMResK'>ADDITIVE</span> 
<span class='PDMVar'>loFTP</span><span class='PDMOper'>=</span><span class='PDMResF'>CREATEOBJECT</span><span class='PDMOper'>(</span><span class='PDMStr'>'ftp_service'</span><span class='PDMOper'>)</span> 

<span class='PDMResK'>IF</span> <span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>OpenInternet</span><span class='PDMOper'>(</span><span class='PDMStr'>"ABONNE"</span><span class='PDMOper'>,</span> <span class='PDMStr'>"PWD"</span><span class='PDMOper'>,</span> <span class='PDMStr'>"10.10.10.10"</span><span class='PDMOper'>,</span> <span class='PDMStr'>"21"</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>IF</span> <span class='PDMOper'>!</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>ChangeFTPDirectory</span><span class='PDMOper'>(</span><span class='PDMStr'>"_!_"</span><span class='PDMOper'>+</span><span class='PDMResF'>CHR</span><span class='PDMOper'>(</span><span class='PDMLit'>1</span><span class='PDMOper'>)</span><span class='PDMOper'>+</span><span class='PDMResF'>CHR</span><span class='PDMOper'>(</span><span class='PDMLit'>9</span><span class='PDMOper'>)</span><span class='PDMOper'>)</span>
      <span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>GetErrorCode</span><span class='PDMOper'>(</span><span class='PDMLit'>.T.</span><span class='PDMOper'>)</span>
   <span class='PDMResK'>ENDIF</span>
   <span class='PDMOper'>=</span><span class='PDMVar'>loFTP</span><span class='PDMOper'>.</span><span class='PDMVar'>CloseInternet</span><span class='PDMOper'>(</span><span class='PDMOper'>)</span> 
<span class='PDMResK'>ENDIF</span>
<span class='PDMResK'>RELEASE</span> <span class='PDMResK'>PROCEDURE</span> <span class='PDMVar'>ftp</span><span class='PDMOper'>.</span><span class='PDMVar'>prg</span></pre>
 <!-- Code End -->


  </div>
 </div><!-- Example End -->

 <div class="PDM_AB_SeeAlso"><!-- SeeAlso Begin -->
  <span class="PDM_AB_Head">
   See also
  </span>
  <div class="PDM_AB_Body">
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.getextendederror.htm" title="Skip to method FTP_SERVICE::GetExtendedError()">FTP_SERVICE::GetExtendedError()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.getextendederrorcode.htm" title="Skip to method FTP_SERVICE::GetExtendedErrorCode()">FTP_SERVICE::GetExtendedErrorCode()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.getextendederrormsg.htm" title="Skip to method FTP_SERVICE::GetExtendedErrorMsg()">FTP_SERVICE::GetExtendedErrorMsg()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.geterrortext.htm" title="Skip to method FTP_SERVICE::GetErrorText()">FTP_SERVICE::GetErrorText()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.nextended_result.htm" title="Skip to property FTP_SERVICE::nExtended_Result">FTP_SERVICE::nExtended_Result</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.cextended_message.htm" title="Skip to property FTP_SERVICE::cExtended_Message">FTP_SERVICE::cExtended_Message</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.getftpdirectoryarray.htm" title="Skip to method FTP_SERVICE::GetFTPDirectoryArray()">FTP_SERVICE::GetFTPDirectoryArray()</a>&nbsp;|
<a class="PDM_AB_See" href="../../code/ftp.prg/cls.ftp_service.nresult_code.htm" title="Skip to property FTP_SERVICE::nResult_Code">FTP_SERVICE::nResult_Code</a>
  </div><!-- Body End -->
  <!--- "Applies to" need to be inserted here---->
  <PlaceAppliesTo_Here />
  <!--- /"Applies to" need to be inserted here---->
 </div><!-- SeeAlso End -->


<!-- /Created with _diamp_pdm_ab by Agnes Beste    03.09.2007 19:34 -->

 <div class="SC">
  <img onclick="ExpandSC('SP_1',-1);"class="imgEC" src="../../imgs/uptab.gif" alt="Expand/Collapse source code of procedure GetErrorCode" id="IMG_SP_1" />
  <span ondblclick="ExpandSC('SP_1',-1);" class="SCCaption"><a name="FTP_SERVICE">Source Code</a></span>
  <div ondblclick="ExpandSC('SP_1',-1);" class="SCE" id="TX_SP_1">
<!-- Code Begin -->
<pre class="PDMCODE PDMNor" >      <span class='PDMResK'>LPARAMETERS</span> <span class='PDMVar'>INP</span> <span class='PDMVar'>llShowMessage</span>
      <span class='PDMResK'>LOCAL</span> <span class='PDMVar'>lcMessage</span>
      <span class='PDMResK'>IF</span> <span class='PDMVar'>llShowMessage</span> <span class='PDMOper'>=</span> <span class='PDMLit'>.T.</span>
<span class='PDMCom'>         * Build Error Message Here</span>
         <span class='PDMVar'>lcMessage</span> <span class='PDMOper'>=</span> <span class='PDMStr'>"Error ("</span> <span class='PDMOper'>+</span> <span class='PDMResF'>ALLTRIM</span><span class='PDMOper'>(</span><span class='PDMResF'>STR</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>nResult_Code</span><span class='PDMOper'>)</span><span class='PDMOper'>)</span> <span class='PDMOper'>+</span> <span class='PDMStr'>")  -  "</span> <span class='PDMOper'>+</span> <span class='PDMOper'>;</span>
                     <span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>GetErrorText</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>nResult_Code</span><span class='PDMOper'>)</span>
         <span class='PDMResK'>IF</span> <span class='PDMOper'>!</span><span class='PDMResF'>EMPTY</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>cExtended_Message</span><span class='PDMOper'>)</span>
            <span class='PDMVar'>lcMessage</span> <span class='PDMOper'>=</span> <span class='PDMVar'>lcMessage</span> <span class='PDMOper'>+</span> <span class='PDMResF'>CHR</span><span class='PDMOper'>(</span><span class='PDMLit'>13</span><span class='PDMOper'>)</span> <span class='PDMOper'>+</span> <span class='PDMResF'>CHR</span><span class='PDMOper'>(</span><span class='PDMLit'>13</span><span class='PDMOper'>)</span> <span class='PDMOper'>+</span> <span class='PDMStr'>"Extended Error Info - ("</span> <span class='PDMOper'>+</span> <span class='PDMOper'>;</span>
                        <span class='PDMResF'>ALLTRIM</span><span class='PDMOper'>(</span><span class='PDMResF'>STR</span><span class='PDMOper'>(</span><span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>nExtended_Result</span><span class='PDMOper'>)</span><span class='PDMOper'>)</span> <span class='PDMOper'>+</span> <span class='PDMOper'>;</span>
                        <span class='PDMStr'>") - "</span> <span class='PDMOper'>+</span> <span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>cExtended_Message</span>
         <span class='PDMResK'>ENDIF</span>
         <span class='PDMOper'>=</span><span class='PDMResF'>MESSAGEBOX</span><span class='PDMOper'>(</span><span class='PDMVar'>lcMessage</span><span class='PDMOper'>,</span> <span class='PDMLit'>48</span><span class='PDMOper'>,</span> <span class='PDMStr'>"FTP Error Message"</span><span class='PDMOper'>)</span>
      <span class='PDMResK'>ENDIF</span>
      <span class='PDMResK'>RETURN</span> <span class='PDMResK'>This</span><span class='PDMOper'>.</span><span class='PDMVar'>nResult_Code</span></pre>
 <!-- Code End -->
  </div>
 </div>
</div>
<div class="diaxp_mfoot"> <div class="PDM_AB_CopyRight"><!-- Footer Begin -->
  <hr />
  <div class="PDM_AB_Body">
&copy; 2004-03-23 Robert Abram, &copy; 24.11.2005 Martina Jindr&uacute;
  </div><!-- Body End -->
 </div><!-- Footer End -->
</div>
<script language="JavaScript" type="text/javascript">
lo=document.getElementById("TX_SP_1");
lo.XType="SourceCode";
lo.Dir="../../imgs/";


</script>
</body>
</html>
